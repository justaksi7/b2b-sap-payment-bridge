<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1783.9329735823515" height="1062.7831768828178"><desc>title%20SAP%20overloaded%2Fslow%20%E2%80%93%20Partner%20Payment%20Flow%20(corrected)%0A%0Aparticipant%20Partner%0Aparticipant%20Gateway%0Aparticipant%20PartnerConfigService%0Aparticipant%20DB%0Aparticipant%20Dispatcher%0Aparticipant%20PubSub%0Aparticipant%20Worker%0Aparticipant%20SAP%0Aparticipant%20WebhookService%0A%0APartner-%3E%3EGateway%3A%20POST%20%2Fv1%2Fpayments%0AGateway-%3E%3EPartnerConfigService%3A%20validate%20%2B%20mapping%0APartnerConfigService--%3E%3EGateway%3A%20OK%0AGateway-%3E%3EDB%3A%20TX%3A%20insert%20payment%20%2B%20outbox(PaymentCreated)%0AGateway--%3E%3EPartner%3A%20202%20Accepted%20%7Bstatus%3A%20%22QUEUED%22%7D%0A%0ADispatcher-%3E%3EDB%3A%20read%20outbox%20(PaymentCreated)%0ADispatcher-%3E%3EPubSub%3A%20publish%20PaymentCreated%0A%0APubSub-%3E%3EWorker%3A%20deliver%20PaymentCreated%0AWorker-%3E%3ESAP%3A%20POST%20payment%20(timeout%20after%2010s)%0Anote%20right%20of%20Worker%3A%20SAP%20responds%20slowly%5CnWorker%20times%20out%0AWorker-%3E%3ESAP%3A%20retry%20after%20backoff%20(20s)%0ASAP--%3E%3EWorker%3A%20200%20OK%0A%0AWorker-%3E%3EDB%3A%20update%20payment.status%3DSETTLED%20%2B%20insert%20outbox(PaymentSettled)%0A%0ADispatcher-%3E%3EDB%3A%20read%20outbox%20(PaymentSettled)%0ADispatcher-%3E%3EPubSub%3A%20publish%20PaymentSettled%0A%0APubSub-%3E%3EWebhookService%3A%20deliver%20PaymentSettled%0AWebhookService-%3E%3EPartnerConfigService%3A%20fetch%20webhook%20URL%20%2B%20signing%20key%0AWebhookService-%3E%3EPartner%3A%20POST%20webhook%20(signed%2C%20status%3DSETTLED)%0APartner--%3E%3EWebhookService%3A%20200%20OK%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1783" height="1062"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 49.928505787628914 95.73914152281817 L 49.928505787628914 1062.7831768828178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 317.3973883750638 95.73914152281817 L 317.3973883750638 1062.7831768828178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 490.938523699543 95.73914152281817 L 490.938523699543 1062.7831768828178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 664.4796590240221 95.73914152281817 L 664.4796590240221 1062.7831768828178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 909.3142795264961 95.73914152281817 L 909.3142795264961 1062.7831768828178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1113.4116258590482 95.73914152281817 L 1113.4116258590482 1062.7831768828178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1314.237670922069 95.73914152281817 L 1314.237670922069 1062.7831768828178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1581.040812542707 95.73914152281817 L 1581.040812542707 1062.7831768828178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1702.7661102507773 95.73914152281817 L 1702.7661102507773 1062.7831768828178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.167601650000002 51.63409261281818 L 91.68940992525782 51.63409261281818 L 91.68940992525782 95.73914152281817 L 8.167601650000002 95.73914152281817 L 8.167601650000002 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.891297230500008" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Partner</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 270.7474232633138 51.63409261281818 L 364.0473534868138 51.63409261281818 L 364.0473534868138 95.73914152281817 L 270.7474232633138 95.73914152281817 L 270.7474232633138 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="288.4711188438138" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Gateway</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 403.547721490625 51.63409261281818 L 578.329325908461 51.63409261281818 L 578.329325908461 95.73914152281817 L 403.547721490625 95.73914152281817 L 403.547721490625 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="421.27141707112503" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">PartnerConfigService</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 636.5734301793619 51.63409261281818 L 692.3858878686823 51.63409261281818 L 692.3858878686823 95.73914152281817 L 636.5734301793619 95.73914152281817 L 636.5734301793619 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="654.297125759862" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DB</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 856.554809715039 51.63409261281818 L 962.0737493379531 51.63409261281818 L 962.0737493379531 95.73914152281817 L 856.554809715039 95.73914152281817 L 856.554809715039 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="874.278505295539" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Dispatcher</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1069.6034728810873 51.63409261281818 L 1157.2197788370092 51.63409261281818 L 1157.2197788370092 95.73914152281817 L 1069.6034728810873 95.73914152281817 L 1069.6034728810873 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1087.3271684615872" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">PubSub</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1273.0279447629557 51.63409261281818 L 1355.4473970811823 51.63409261281818 L 1355.4473970811823 95.73914152281817 L 1273.0279447629557 95.73914152281817 L 1273.0279447629557 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1290.7516403434556" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Worker</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1548.649979816211 51.63409261281818 L 1613.4316452692033 51.63409261281818 L 1613.4316452692033 95.73914152281817 L 1548.649979816211 95.73914152281817 L 1548.649979816211 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1566.373675396711" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SAP</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1629.7668485692031 51.63409261281818 L 1775.7653719323516 51.63409261281818 L 1775.7653719323516 95.73914152281817 L 1629.7668485692031 95.73914152281817 L 1629.7668485692031 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1647.490544149703" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">WebhookService</text></g></g><g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16pt" font-style="normal" font-weight="normal" text-decoration="normal" x="618.2409286499023" y="24.651306798181814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SAP overloaded/slow – Partner Payment Flow (corrected)</text></g><g><rect fill="white" stroke="none" x="115.62570674747919" y="128.4095481228182" width="136.07448066773438" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="118.07598724247919" y="143.1112310928182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /v1/payments</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 49.928505787628914 149.64531241281819 L 315.3554879625638 149.64531241281819" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(317.3973883750638,149.64531241281819) translate(-317.3973883750638,-149.64531241281819)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 303.40214399200977 143.40191492719475 L 315.86708850951436 149.64531241281819 L 303.40214399200977 155.88870989844162" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="339.98183569855337" y="174.1481173628182" width="128.3722406775" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="342.4321161935534" y="188.84980033281818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">validate + mapping</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 317.3973883750638 195.3838816528182 L 488.896623287043 195.3838816528182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(490.938523699543,195.3838816528182) translate(-490.938523699543,-195.3838816528182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 476.94327931648894 189.14048416719476 L 489.40822383399353 195.3838816528182 L 476.94327931648894 201.62727913844162" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="391.12712225861196" y="219.8866866028182" width="26.08166755738281" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="393.577402753612" y="234.58836957281818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">OK</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 490.938523699543 241.1224508928182 L 319.43928878756384 241.1224508928182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(317.3973883750638,241.1224508928182) translate(-317.3973883750638,-241.1224508928182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 331.3926327581179 234.87905340719476 L 318.9276882406133 241.1224508928182 L 331.3926327581179 247.36584837844163" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="336.7273789467305" y="265.62525584281815" width="308.422289505625" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="339.1776594417305" y="280.3269388128181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TX: insert payment + outbox(PaymentCreated)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 317.3973883750638 286.86102013281817 L 662.4377586115221 286.86102013281817" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(664.4796590240221,286.86102013281817) translate(-664.4796590240221,-286.86102013281817)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 650.4844146409681 280.6176226471947 L 662.9493591584726 286.86102013281817 L 650.4844146409681 293.10441761844163" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="69.25849635929559" y="311.36382508281815" width="228.80890144410156" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="71.70877685429559" y="326.06550805281813" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">202 Accepted {status: "QUEUED"}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 317.3973883750638 332.5995893728182 L 51.97040620012891 332.5995893728182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(49.928505787628914,332.5995893728182) translate(-49.928505787628914,-332.5995893728182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 63.92375017068295 326.3561918871947 L 51.458805653178395 332.5995893728182 L 63.92375017068295 338.84298685844163" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="683.8096495956888" y="357.10239432281816" width="206.17463935914063" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="686.2599300906888" y="371.80407729281814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">read outbox (PaymentCreated)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 909.3142795264961 378.3381586128182 L 666.5215594365221 378.3381586128182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(664.4796590240221,378.3381586128182) translate(-664.4796590240221,-378.3381586128182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 678.4749034070761 372.0947611271947 L 666.0099588895716 378.3381586128182 L 678.4749034070761 384.58155609844164" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="928.6442700981627" y="402.84096356281816" width="165.43736518921875" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="931.0945505931627" y="417.54264653281814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">publish PaymentCreated</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 909.3142795264961 424.0767278528182 L 1111.3697254465483 424.0767278528182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1113.4116258590482,424.0767278528182) translate(-1113.4116258590482,-424.0767278528182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1099.416381475994 417.8333303671947 L 1111.8813259934986 424.0767278528182 L 1099.416381475994 430.32012533844164" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="1132.7416164307149" y="448.57953280281816" width="162.1660639196875" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1135.191896925715" y="463.28121577281814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">deliver PaymentCreated</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1113.4116258590482 469.8152970928182 L 1312.195770509569 469.8152970928182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1314.237670922069,469.8152970928182) translate(-1314.237670922069,-469.8152970928182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1300.2424265390148 463.5718996071947 L 1312.7073710565194 469.8152970928182 L 1300.2424265390148 476.05869457844165" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="1333.5676614937356" y="494.31810204281817" width="228.1431604773047" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1336.0179419887356" y="509.01978501281815" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST payment (timeout after 10s)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1314.237670922069 515.5538663328182 L 1578.9989121302071 515.5538663328182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1581.040812542707,515.5538663328182) translate(-1581.040812542707,-515.5538663328182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1567.045568159653 509.3104688471947 L 1579.5105126771575 515.5538663328182 L 1567.045568159653 521.7972638184416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1314.237670922069 567.0097567278183 L 1322.405272572069 567.0097567278183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1322.405272572069 540.0566712828182 L 1491.144307279569 540.0566712828182 L 1505.845990249569 554.7583542528182 L 1505.845990249569 593.9628421728182 L 1322.405272572069 593.9628421728182 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1491.144307279569 540.0566712828182 L 1491.144307279569 554.7583542528182 L 1505.845990249569 554.7583542528182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1345.2745571920689" y="562.9259559028183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SAP responds slowly</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1345.2745571920689" y="579.2611592028182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Worker times out</text></g><g><rect fill="white" stroke="none" x="1369.5519220528176" y="618.4656471228182" width="156.17463935914063" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1372.0022025478177" y="633.1673300928181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">retry after backoff (20s)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1314.237670922069 639.7014114128182 L 1578.9989121302071 639.7014114128182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1581.040812542707,639.7014114128182) translate(-1581.040812542707,-639.7014114128182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1567.045568159653 633.4580139271948 L 1579.5105126771575 639.7014114128182 L 1567.045568159653 645.9448088984416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="1420.3321268257669" y="664.2042163628181" width="54.61422981324219" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1422.7824073207669" y="678.9058993328181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 OK</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1581.040812542707 685.4399806528181 L 1316.2795713345688 685.4399806528181" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(1314.237670922069,685.4399806528181) translate(-1314.237670922069,-685.4399806528181)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1328.232915305123 679.1965831671947 L 1315.7679707876184 685.4399806528181 L 1328.232915305123 691.6833781384415" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="768.5226270317564" y="709.942785602818" width="441.672045365" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="770.9729075267564" y="724.644468572818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">update payment.status=SETTLED + insert outbox(PaymentSettled)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1314.237670922069 731.1785498928181 L 666.5215594365221 731.1785498928181" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(664.4796590240221,731.1785498928181) translate(-664.4796590240221,-731.1785498928181)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 678.4749034070761 724.9351524071947 L 666.0099588895716 731.1785498928181 L 678.4749034070761 737.4219473784415" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="687.0666304916849" y="755.681354842818" width="199.66067756714844" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="689.5169109866849" y="770.383037812818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">read outbox (PaymentSettled)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 909.3142795264961 776.917119132818 L 666.5215594365221 776.917119132818" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(664.4796590240221,776.917119132818) translate(-664.4796590240221,-776.917119132818)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 678.4749034070761 770.6737216471946 L 666.0099588895716 776.917119132818 L 678.4749034070761 783.1605166184414" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="931.9012509941588" y="801.4199240828179" width="158.92340339722656" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="934.3515314891588" y="816.1216070528179" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">publish PaymentSettled</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 909.3142795264961 822.655688372818 L 1111.3697254465483 822.655688372818" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1113.4116258590482,822.655688372818) translate(-1113.4116258590482,-822.655688372818)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1099.416381475994 816.4122908871946 L 1111.8813259934986 822.655688372818 L 1099.416381475994 828.8990858584414" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="1330.2628169910652" y="847.1584933228179" width="155.65210212769531" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1332.7130974860652" y="861.8601762928179" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">deliver PaymentSettled</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1113.4116258590482 868.3942576128179 L 1700.7242098382774 868.3942576128179" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1702.7661102507773,868.3942576128179) translate(-1702.7661102507773,-868.3942576128179)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1688.7708658677232 862.1508601271945 L 1701.2358103852278 868.3942576128179 L 1688.7708658677232 874.6376550984413" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="985.4077966730313" y="892.8970625628178" width="222.88904060425781" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="987.8580771680313" y="907.5987455328178" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">fetch webhook URL + signing key</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1702.7661102507773 914.1328268528179 L 492.980424112043 914.1328268528179" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(490.938523699543,914.1328268528179) translate(-490.938523699543,-914.1328268528179)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 504.93376808259706 907.8894293671945 L 492.46882356509246 914.1328268528179 L 504.93376808259706 920.3762243384413" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="733.1418700534999" y="938.6356318028178" width="286.4108759314062" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="735.5921505485" y="953.3373147728178" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST webhook (signed, status=SETTLED)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1702.7661102507773 959.8713960928178 L 51.97040620012891 959.8713960928178" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(49.928505787628914,959.8713960928178) translate(-49.928505787628914,-959.8713960928178)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 63.92375017068295 953.6279986071944 L 51.458805653178395 959.8713960928178 L 63.92375017068295 966.1147935784412" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="849.040193112582" y="984.3742010428177" width="54.61422981324219" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="851.490473607582" y="999.0758840128177" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 OK</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 49.928505787628914 1005.6099653328178 L 1700.7242098382774 1005.6099653328178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(1702.7661102507773,1005.6099653328178) translate(-1702.7661102507773,-1005.6099653328178)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1688.7708658677232 999.3665678471943 L 1701.2358103852278 1005.6099653328178 L 1688.7708658677232 1011.8533628184412" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/></g></svg>